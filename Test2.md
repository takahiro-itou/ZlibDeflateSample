
# Test Data 2

- データ準備

```
import zlib

text = b'\xff' * 32
enc = zlib.compress(text)

with open('Test1.z', 'wb') as fw:
    fw.write(enc)
```

- 元データ (32 bytes)

```
FF FF FF FF FF FF FF FF  FF FF FF FF FF FF FF FF
FF FF FF FF FF FF FF FF  FF FF FF FF FF FF FF FF
```

- 圧縮データ (12 bytes)

```
78 9C FB FF 1F 3F 00 00  0E 2E 1F E1
```

##  ヘッダ

- 78 9C

```
・0111 1000  1001 1100
↓
・0111 1000 10 0 11100

0111  : Window Size = 7 => 2^(7+8) = 32k
1000  : 圧縮モード 8 (Z_DEFLATE)
10    : 圧縮レベル 2
0     : プリセット辞書 (なし)
11100 : ヘッダチェック
```

##  Deflate ブロック

```
Bytes: FB FF 1F 3F 00 00
Bits:
002:    1101 1111
003:    1111 1111
004:    1111 1000
005:    1111 1100
006:    0000 0000
007:    0000 0000
...
```

Deflate ヘッダ

|  Size  | Value |     Comment     |
|-------:|:------|:----------------|
|  1 bit | 1     | 最終ブロック    |
|  2 bit | 01    | 固定ハフマン    |


###  データ本体の解析

```
IN : 002:   ...1 1111   1111 ....
111111111 => 255
OUT: FF
```

```
IN : 003:   .... 1111   1111 1...
111111111 => 255
OUT: FF FF
```

```
IN : 004:   .... .000   1111 1100   000. ....

0001111 => 271 => 一致長ベース 27, 拡張ビット 2
拡張ビット  11 => 3,
一致長  = 27 + 3 = 30
距離    = 00000  =  1
OUT: 00 00 00(x30)
```

```
IN: 006:    ...0 0000   00.. ....
0000000 => 256
終端
```

##  チェックサム

- Adler-32

```
008:    0E 2E 1F E1
```

